{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/logger.service\";\nimport * as i2 from \"../../../services/category.service\";\nimport * as i3 from \"../../../services/product.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/router\";\nimport * as i7 from \"../../notification/notification.component\";\n\nfunction ProductsListComponent_app_notification_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-notification\", 17);\n    i0.ɵɵelementStart(1, \"span\", 18);\n    i0.ɵɵtext(2, \"Le produit a \\u00E9t\\u00E9 retir\\u00E9.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProductsListComponent_app_notification_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-notification\", 19);\n    i0.ɵɵelementStart(1, \"span\", 18);\n    i0.ɵɵtext(2, \"Quelque chose s'est mal pass\\u00E9.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProductsListComponent_app_notification_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"app-notification\", 19);\n    i0.ɵɵelementStart(1, \"span\", 18);\n    i0.ɵɵtext(2, \"Vous devez \\u00EAtre un administrateur pour effectuer cette op\\u00E9ration.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ProductsListComponent_option_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const c_r7 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", c_r7.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(c_r7.name);\n  }\n}\n\nconst _c0 = function (a1) {\n  return [\"/admin/product\", a1];\n};\n\nfunction ProductsListComponent_tr_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelementStart(1, \"td\", 21);\n    i0.ɵɵelement(2, \"img\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵelementStart(4, \"p\", 23);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 24);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\", 25);\n    i0.ɵɵelementStart(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\", 26);\n    i0.ɵɵelementStart(13, \"button\", 27);\n    i0.ɵɵelement(14, \"i\", 28);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function ProductsListComponent_tr_31_Template_button_click_15_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const p_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.onDelete(p_r8.id);\n    });\n    i0.ɵɵelement(16, \"i\", 30);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const p_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", p_r8.imageUrl, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(p_r8.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(p_r8.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"\", i0.ɵɵpipeBind2(11, 6, p_r8.price, \"EUR\"), \"/\", p_r8.unit, \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(9, _c0, p_r8.id));\n  }\n}\n\nexport let ProductsListComponent = /*#__PURE__*/(() => {\n  class ProductsListComponent {\n    constructor(logger, categoryService, productService) {\n      this.logger = logger;\n      this.categoryService = categoryService;\n      this.productService = productService;\n      this.categoryId = 0;\n      this.notificationRed = false;\n      this.notificationGreen = false;\n      this.notificationRedAdmin = false;\n    }\n\n    ngOnInit() {\n      this.categoryService.getCategories().subscribe(res => {\n        this.categories = res;\n      });\n      this.subscription = this.productService.getProducts().subscribe(res => {\n        this.filterProducts = this.products = res;\n      });\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    } //Sleep function for notification\n\n\n    sleep(time) {\n      return new Promise(resolve => setTimeout(resolve, time));\n    } //Delete product\n\n\n    onDelete(id) {\n      //Check if admin\n      if (!this.logger.isAdmin()) {\n        //Notification no admin\n        this.notificationRedAdmin = true;\n        this.sleep(2500).then(() => {\n          this.notificationRedAdmin = false;\n        });\n        return;\n      }\n\n      this.productService.deleteProduct(id).subscribe(res => {\n        this.productService.getProducts().subscribe(res => {\n          this.filterProducts = this.products = res; //Notification all good\n\n          this.notificationGreen = true;\n          this.sleep(2500).then(() => {\n            this.notificationGreen = false;\n          });\n        });\n      }, err => {\n        //Notification error\n        this.notificationRed = true;\n        this.sleep(2500).then(() => {\n          this.notificationRed = false;\n        });\n      });\n    }\n\n    onSelect(categoryId) {\n      this.filterProducts = categoryId > 0 ? this.products.filter(p => p.categoryId == categoryId) : this.products;\n    }\n\n    filter(query) {\n      this.filterProducts = query ? this.products.filter(p => p.title.toLowerCase().includes(query.toLowerCase())) : this.products;\n    }\n\n  }\n\n  ProductsListComponent.ɵfac = function ProductsListComponent_Factory(t) {\n    return new (t || ProductsListComponent)(i0.ɵɵdirectiveInject(i1.LoggerService), i0.ɵɵdirectiveInject(i2.CategoryService), i0.ɵɵdirectiveInject(i3.ProductService));\n  };\n\n  ProductsListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductsListComponent,\n    selectors: [[\"app-product-list\"]],\n    decls: 32,\n    vars: 5,\n    consts: [[\"class\", \"theme-green\", 4, \"ngIf\"], [\"class\", \"theme-red\", 4, \"ngIf\"], [\"action\", \"\", 1, \"search-box-container\", \"search-prd\"], [1, \"admin-title\"], [\"type\", \"search\", \"placeholder\", \"Rechercher un produit...\", 1, \"search-product\", 3, \"keyup\"], [\"query\", \"\"], [1, \"box-select-categories\"], [\"id\", \"cat\", \"for\", \"category\"], [\"name\", \"category\", \"id\", \"category\", 1, \"select-categories\", 3, \"change\"], [\"categoryId\", \"\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"add-prod\"], [\"routerLink\", \"/admin/product/new\", 1, \"btn-admin\"], [1, \"fas\", \"fa-plus\"], [1, \"tbl\"], [4, \"ngFor\", \"ngForOf\"], [1, \"theme-green\"], [1, \"msg-text-add\"], [1, \"theme-red\"], [3, \"value\"], [1, \"td-img\"], [3, \"src\"], [1, \"td-title\"], [1, \"td-description\"], [1, \"td-price\"], [1, \"td-btn\"], [1, \"btn-edit\", 3, \"routerLink\"], [1, \"fas\", \"fa-edit\"], [1, \"btn-delete\", 3, \"click\"], [1, \"fas\", \"fa-trash-alt\"]],\n    template: function ProductsListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r11 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵtemplate(0, ProductsListComponent_app_notification_0_Template, 3, 0, \"app-notification\", 0);\n        i0.ɵɵtemplate(1, ProductsListComponent_app_notification_1_Template, 3, 0, \"app-notification\", 1);\n        i0.ɵɵtemplate(2, ProductsListComponent_app_notification_2_Template, 3, 0, \"app-notification\", 1);\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵelementStart(4, \"span\", 3);\n        i0.ɵɵtext(5, \"Liste de produits\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"input\", 4, 5);\n        i0.ɵɵlistener(\"keyup\", function ProductsListComponent_Template_input_keyup_6_listener() {\n          i0.ɵɵrestoreView(_r11);\n\n          const _r3 = i0.ɵɵreference(7);\n\n          return ctx.filter(_r3.value);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"div\", 6);\n        i0.ɵɵelementStart(9, \"label\", 7);\n        i0.ɵɵtext(10, \"Category\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"select\", 8, 9);\n        i0.ɵɵlistener(\"change\", function ProductsListComponent_Template_select_change_11_listener() {\n          i0.ɵɵrestoreView(_r11);\n\n          const _r4 = i0.ɵɵreference(12);\n\n          return ctx.onSelect(_r4.value);\n        });\n        i0.ɵɵelementStart(13, \"option\", 10);\n        i0.ɵɵtext(14, \"Tout\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(15, ProductsListComponent_option_15_Template, 2, 2, \"option\", 11);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"span\", 12);\n        i0.ɵɵelementStart(17, \"a\", 13);\n        i0.ɵɵtext(18, \"Ajouter\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(19, \"span\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(20, \"table\", 15);\n        i0.ɵɵelementStart(21, \"thead\");\n        i0.ɵɵelementStart(22, \"tr\");\n        i0.ɵɵelementStart(23, \"th\");\n        i0.ɵɵtext(24, \"Photo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"th\");\n        i0.ɵɵtext(26, \"Titre/Description\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"th\");\n        i0.ɵɵtext(28, \"Prix/Unit\\u00E9\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(29, \"th\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"tbody\");\n        i0.ɵɵtemplate(31, ProductsListComponent_tr_31_Template, 17, 11, \"tr\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.notificationGreen);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.notificationRed);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.notificationRedAdmin);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"ngForOf\", ctx.categories);\n        i0.ɵɵadvance(16);\n        i0.ɵɵproperty(\"ngForOf\", ctx.filterProducts);\n      }\n    },\n    directives: [i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i4.NgForOf, i6.RouterLinkWithHref, i7.NotificationComponent, i6.RouterLink],\n    pipes: [i4.CurrencyPipe],\n    styles: [\".search-box-container[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.5rem 0}.tbl[_ngcontent-%COMP%]{width:100%;margin:auto}.tbl[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#0271dc;color:#fff;height:4rem;font-size:2rem}.tbl[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:20%}.search-product[_ngcontent-%COMP%]{height:80%;width:25%;padding:5px;margin-left:-5px;font-size:2rem;color:#333;border:.1rem solid #b2b2b2;box-shadow:0 1px 4px #00000029;border-radius:3px}.fa-plus[_ngcontent-%COMP%]{color:green;font-size:3rem;cursor:pointer}.add-prod[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #b2b2b2;box-shadow:0 1px 4px #00000029;height:36px;border-radius:3px;display:flex;align-items:center;padding:0 1rem}.btn-admin[_ngcontent-%COMP%]{font-size:2rem;padding:20px;color:#838383;margin-left:2px}.search-prd[_ngcontent-%COMP%]{margin:0 2px;justify-content:space-around;color:#fff;background-color:#e6e6e6;grid-gap:1rem;gap:1rem}.box-select-categories[_ngcontent-%COMP%]{background-color:#fff;display:flex;justify-content:space-between;height:80%;width:25%;border:1px solid #b2b2b2;box-shadow:0 1px 4px #00000029;border-radius:3px}.box-select-categories[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{line-height:35px;padding:0 1rem;font-size:2rem;color:#757575;background-color:#fff}.select-categories[_ngcontent-%COMP%]{width:50%;font-size:2rem}td[_ngcontent-%COMP%]{border-bottom:1px solid grey}.td-btn[_ngcontent-%COMP%], .td-img[_ngcontent-%COMP%], .td-price[_ngcontent-%COMP%]{text-align:center}td[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:75px;width:auto}.td-title[_ngcontent-%COMP%], td[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:2rem}.td-description[_ngcontent-%COMP%]{font-size:1.5rem!important;color:grey}.btn-delete[_ngcontent-%COMP%], .btn-edit[_ngcontent-%COMP%]{padding:1rem;margin:2px;border-radius:3px;border:none;color:#fff;font-size:2rem;width:6rem}.btn-delete[_ngcontent-%COMP%]:hover, .btn-edit[_ngcontent-%COMP%]:hover{cursor:pointer}.btn-edit[_ngcontent-%COMP%]{background-color:#72a73b}.btn-delete[_ngcontent-%COMP%]{background-color:#e95e5d}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#5a8a25}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#e04746}@media (max-width:768px){#cat[_ngcontent-%COMP%], .admin-title[_ngcontent-%COMP%]{display:none}#category[_ngcontent-%COMP%]{width:100%}.btn-delete[_ngcontent-%COMP%], .btn-edit[_ngcontent-%COMP%]{width:8rem}}\"]\n  });\n  return ProductsListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}